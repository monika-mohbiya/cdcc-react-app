import{r as g,u as I,a as L,j as e}from"./index-WH5TZW5v.js";function M(){const[C,y]=g.useState(!1),_=I(),{enroll:b}=L(),[n,T]=g.useState({}),[A,R]=g.useState([]),O=["1312","1361","1406","668","788","549","553","577","624","744","908"],r={textAlign:"left",padding:"8px 12px",background:"#f3f3f3",border:"1px solid black",width:"200px"},i={padding:"8px 12px",border:"1px solid black"},D={display:"block ",position:"relative",alignItems:"center",marginRight:"4px",marginLeft:"4px",alignSelf:"center"},E={display:"flex",alignItems:"center",padding:"4px"};function N(s){return["A","B","C","D"][s]||""}const v=s=>O.includes(s);g.useEffect(()=>{if(!localStorage.getItem("token"))return;async function l(){try{const h=await(await fetch("/cdcc-react-app/model/candidate.json")).json(),a=await(await fetch("/cdcc-react-app/model/cdcc_bank.questions.json")).json(),u=await(await fetch("/cdcc-react-app/model/Response.json")).json();let d=0,f=0;const o=h.find(t=>t.enroll===b);if(!o)return console.error("Student not found");const w=o.papershiftid,S=a.filter(t=>t.papershiftid==w),Q=u.filter(t=>t.enrollment==b&&t.papershiftid==w);S.forEach(t=>{const p=Q.find(j=>j.qid==t.q_id);if(p){t.response=p.response,t.rstatus=p.rstatus;let j=!1;t.options.map(x=>{x.selected=!1,x.opt_id==p.response&&(x.selected=!0,f++),x.opt_id==p.response&&x.iscorrect==!0&&(d+=1,j=!0)}),!j&&v(t.q_id)&&(d+=1)}}),console.log("obtainedMarks",d),console.log("selectedOpt",f),o.obtainedMarks=d,o.selectedOpt=f,T(o),R(S)}catch(c){console.error("Error loading data",c)}}l()},[_]);const $=async()=>{y(!0);try{window.print()}catch(s){console.error("❌ html2canvas failed:",s)}finally{y(!1)}};return e.jsxs("div",{style:{maxWidth:1e3,margin:"24px auto",padding:"0 16px"},children:[e.jsx("div",{style:{textAlign:"center",marginBottom:24},children:e.jsx("img",{src:"cdcclogo.png",alt:"CDCC LOGO"})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"",children:e.jsx("h2",{style:{margin:0},children:"Answer Key"})}),e.jsxs("div",{className:"",children:[e.jsx("button",{className:"btn btn-primary d-flex align-self-center blue-color",onClick:()=>$(),children:e.jsx("span",{className:"",children:"Download"})}),C&&e.jsx("div",{style:{textAlign:"center",marginTop:10},children:"⏳ Generating PDF, please wait..."})]})]}),e.jsxs("div",{className:"border",children:[e.jsx("div",{className:"",style:{border:"2px solid black",padding:"10px",margin:"5px"},children:e.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{style:r,children:"Enrollment"}),e.jsx("td",{style:i,children:n.enroll})]}),e.jsxs("tr",{children:[e.jsx("th",{style:r,children:"Name"}),e.jsx("td",{style:i,children:n.name})]}),e.jsxs("tr",{children:[e.jsx("th",{style:r,children:"Post"}),e.jsx("td",{style:i,children:n.post})]}),e.jsxs("tr",{children:[e.jsx("th",{style:r,children:"Registration No."}),e.jsx("td",{style:i,children:n.regNo})]}),e.jsxs("tr",{children:[e.jsx("th",{style:r,children:"Date of Birth"}),e.jsx("td",{style:i,children:n.dob})]}),e.jsxs("tr",{children:[e.jsx("th",{style:r,children:"Center Code"}),e.jsx("td",{style:i,children:n.centerCode})]}),e.jsxs("tr",{children:[e.jsx("th",{style:r,children:"Obtain Marks"}),e.jsx("td",{style:i,children:n.obtainedMarks})]}),e.jsxs("tr",{children:[e.jsx("th",{style:r,children:"Chosen options"}),e.jsx("td",{style:i,children:n.selectedOpt})]})]})})}),e.jsxs("div",{className:"mb-2 mt-2 innerWrap",style:{border:"2px solid black",padding:"2px",margin:"5px"},children:[e.jsxs("h4",{className:"",style:{textAlign:"center",fontWeight:"bold",marginTop:"2px"},children:["For ",n.post]}),e.jsx("h5",{className:"text-left ",style:{textAlign:"left",margin:"0px",paddingLeft:"10px"},children:"Notes:"}),e.jsxs("ul",{style:{marginTop:"0px",marginBottom:"0px"},children:[e.jsxs("li",{style:{fontSize:"small"},children:[e.jsx("span",{className:"iscorrect",children:"Green border"})," means Correct Option"]}),e.jsxs("li",{style:{fontSize:"small"},children:[e.jsx("span",{className:"material-symbols-outlined",style:{paddingTop:"4px",border:"2px solid blue",borderRadius:"6px",width:"16px",height:"16px",padding:"4px",position:"relative",top:"8px"},children:e.jsx("img",{src:"touch_app.svg",alt:"Touch Icon",style:{width:"16px",height:"16px"}})})," ",e.jsx("span",{className:"",style:{position:"absolute",marginTop:"2px"},children:"Means Chosen option"})]})]}),e.jsx("div",{className:"container-fluid box_card ",children:e.jsx("div",{className:"row mt-2 answerKeyBg ",children:e.jsx("div",{className:"col-12 scroll",id:"qpackkdiv",children:A?.map((s,l)=>{const c=`${s?.q_id||"q"}-${l}`,h=v(s?.q_id),k=["668","788"].includes(String(s?.q_id||""))?"As the question or its options are doubtful, Grace mark for this question shall be given to all.":"As the question or its options are incorrect, Grace mark for this question shall be given to all.";return e.jsx("div",{className:"card mb-3 p-2",children:e.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:e.jsxs("tbody",{children:[e.jsx("tr",{children:e.jsxs("td",{children:[e.jsx("div",{className:"d-flex justify-content-between",children:e.jsxs("span",{className:"qno",children:["Q no. ",l+1," ["," ",e.jsx("span",{className:"rstatus",children:s?.rstatus})," ","]"," ",e.jsxs("span",{className:"q_id",children:["( ",s?.q_id," )"]})]})}),h&&e.jsxs("span",{className:"remarksQ",children:["Remark: ",k]}),e.jsx("br",{}),s?.isReported&&e.jsxs("span",{className:"reportSpan",children:["Report: ",s?.report]})]})}),e.jsx("tr",{children:e.jsx("td",{children:e.jsx("img",{className:"img-fluid img-bordered",src:`/cdcc-react-app/uploads/questions/${s?.papershiftid}/${s?.q_id}.png`,alt:`Question ${l+1}`})})}),Array.isArray(s?.options)&&s.options.map((a,m)=>{const u=`${c}-opt-${a?.opt_id||m}`,d=a?.iscorrect||h?"iscorrect":"border";return e.jsx("tr",{children:e.jsx("td",{children:e.jsxs("div",{className:"mb-1",style:E,children:[a?.selected&&e.jsx("span",{className:"material-symbols-outlined",style:{paddingTop:"4px",border:"2px solid blue",borderRadius:"6px",width:"16px",height:"16px",padding:"4px",position:"relative",top:"8px"},children:e.jsx("img",{src:"touch_app.svg",alt:"Touch Icon",style:{width:"16px",height:"16px",position:"absolute"}})}),e.jsx("span",{className:"p-3",style:D,children:N(m)}),e.jsx("img",{className:`img-fluid ${d}`,src:`/cdcc-react-app/uploads/options/${s?.papershiftid}/${a?.opt_id}.png`,alt:`Option ${N(m)}`}),e.jsx("span",{})]})})},u)})]})})},c)})})})})]})]})]})}export{M as default};
